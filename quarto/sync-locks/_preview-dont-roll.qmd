
### preview: general sync  {.smaller}


* lots of coordinating threads beyond locks
* will talk about two general tools later: 

   * monitors/condition variables
   * semaphores [if time]

* big added feature: wait for arbitrary thing to happen 
<hr class="vspace" />
* also some less general tools: barriers


### a bad idea  {.smaller}



* one <em>bad</em> idea to wait for an event:
 
```c
pthread_mutex_t lock = PTHREAD_MUTEX_INITIALIZER; bool ready = false;
void WaitForReady() {
    pthread_mutex_lock(&lock);
    do {
        pthread_mutex_unlock(&lock);
        /* only time MarkReady() can run */
        pthread_mutex_lock(&lock);
    } while (!ready);
    pthread_mutex_unlock(&lock);
}
void MarkReady() {
    pthread_mutex_lock(&lock);
    ready = true;
    pthread_mutex_unlock(&lock);
}

```
 

* wastes processor time; MarkReady can stall waiting for unlock window

::: {style="position: absolute; opacity: 0.15; z-index: 10; top: 50%; left: 50%; transform: translate(-50%, -50%) rotate(25deg); font-size: 300%; width: 100%;"}

DO NOT USE THIS CODE

:::


