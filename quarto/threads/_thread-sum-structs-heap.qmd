
### sum example (on heap)  {.smaller}


<pre><code>struct ThreadInfo { <span data-fragment-index="3" class="fragment custom myem-only">pthread_t thread;</span> int *values; int start; int end; int result };
void *sum_thread(void *argument) {
    ...
}

struct ThreadInfo *start_sum_all(int *values) {
    struct ThreadInfo *info = <span data-fragment-index="2" class="fragment custom myem-only">calloc(2, sizeof(struct ThreadInfo));</span>
    for (int i = 0; i &lt; 2; ++i) {
        info\[i].values = values; info\[i].start = i*512; info\[i].end = (i+1)*512;
        pthread_create(&amp;info\[i].thread, NULL, sum_thread, (void *) <span data-fragment-index="2" class="fragment custom myem-only">&amp;info[i]</span>);
    }
    return info;
}

int finish_sum_all(ThreadInfo *info) {
    for (int i = 0; i &lt; 2; ++i)
        pthread_join(<span data-fragment-index="3" class="fragment custom myem-only">info[i].thread</span>, NULL);
    int result = info\[0].result + info\[1].result;
    free(info);
    return result;
}
</code></pre>

