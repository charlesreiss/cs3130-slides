
### talking with the terminal  {.smaller}

<!-- \lstset{
    language=C++,style=smaller,
    moredelim={**[is][\btHL<1,2|handout:2>]{@2}{2@}},
    moredelim={**[is][\btHL<1,3|handout:3>]{@3}{3@}},
    moredelim={**[is][\btHL<1,4|handout:4>]{@4}{4@}},
    moredelim={**[is][\btHL<1,5|handout:5>]{@5}{5@}},
    moredelim={**[is][\btHL<1,6|handout:6>]{@6}{6@}},
} -->
 
<pre><code>printf("Name: ");
char input\[1000];
[[fgets(input, sizeof input, stdin);]{.fragment fragment-index=1 .custom .myem-only}]{.fragment fragment-index=2 .custom .myem-only}
fprintf(logfile, "Got name %s\\n", input);
printf("Enter command: ");
[[fgets(input, sizeof input, stdin);]{.fragment fragment-index=1 .custom .myem-only}]{.fragment fragment-index=2 .custom .myem-only}
...
</code></pre>


### talking with terminal w/ fread  {.smaller}

<!-- \lstset{
    language=C++,style=smaller,
    moredelim={**[is][\btHL<2|handout:2>]{@2}{2@}},
    moredelim={**[is][\btHL<3|handout:3>]{@3}{3@}},
    moredelim={**[is][\btHL<4|handout:4>]{@4}{4@}},
    moredelim={**[is][\btHL<5|handout:5>]{@5}{5@}},
    moredelim={**[is][\btHL<6|handout:6>]{@6}{6@}},
} -->
 
<pre><code>/* missing below: error checking */
const char *msg = "Name: ";
<span data-fragment-index="3" class="fragment custom myem-only">fwrite(msg, 1, strlen(msg), stdout);</span>

<span data-fragment-index="2" class="fragment custom myem-only">char input[1000] = ""; int count = 0;</span>
<span data-fragment-index="2" class="fragment custom myem-only">do {</span>
    <span data-fragment-index="2" class="fragment custom myem-only">count += @3fread(input + count, 1, 1000 - count, stdin);3@</span>
<span data-fragment-index="2" class="fragment custom myem-only">} while (!strchr(input, '\n') &amp;&amp; count &lt; 1000);</span>
fprintf(logfile, "Got name %s\\n", <span data-fragment-index="2" class="fragment custom myem-only">first_line_of(input)</span>);

msg = "Enter command: "; <span data-fragment-index="3" class="fragment custom myem-only">fwrite(msg, 1, strlen(msg), stdout);</span>

strcpy(input, after_first_line_of(input)); count = strlen(input);
while (!strchr(input, '\\n') &amp;&amp; count &lt; 1000) {
    count += <span data-fragment-index="3" class="fragment custom myem-only">fread(input + count, 1, 1000 - count, stdin);</span>
}
...
</code></pre>
 ![](/network/texfig/use-connected-socket-talking-with-terminal-w-fread.figure-1.svg){.absolute top="0%" left="0%" width=1050 height=600 .my-center  .fragment .fade-in-then-out fragment-index=1}
![](/network/texfig/use-connected-socket-talking-with-terminal-w-fread.figure-2.svg){.absolute top="0%" left="0%" width=1050 height=600 .my-center  .fragment .fade-in-then-out fragment-index=2}


### using a connected socket  {.smaller}

<!-- \lstset{
    language=C++,style=smaller,
    moredelim={**[is][\btHL<2,4|handout:2>]{@2}{2@}},
    moredelim={**[is][\btHL<3|handout:3>]{@3}{3@}},
    moredelim={**[is][\btHL<4|handout:4>]{@4}{4@}},
    moredelim={**[is][\btHL<5|handout:5>]{@5}{5@}},
    moredelim={**[is][\btHL<6|handout:6>]{@6}{6@}},
} -->
 
<pre><code>/* missing below: error checking */
[[int socket_fd = GetSocketFileDescriptorSomehow();]{.fragment fragment-index=2 .custom .myem-only}]{.fragment fragment-index=4 .custom .myem-only}
const char *msg = "Name: ";
<span data-fragment-index="3" class="fragment custom myem-only">write(socket_fd, msg, strlen(msg));</span>

char input\[1000]; int count = 0;
do {
    count += <span data-fragment-index="3" class="fragment custom myem-only">read(socket_fd, input + count, 1000 - count);</span>
} while (!strchr(input, '\\n') &amp;&amp; count &lt; 1000);
fprintf(logfile, "Got name %s\\n", first_line_of(input));

msg = "Enter command: "; <span data-fragment-index="3" class="fragment custom myem-only">write(socket_fd, msg, strlen(msg));</span>

strcpy(input, after_first_line_of(input)); count = strlen(input);
while (!strchr(input, '\\n') &amp;&amp; count &lt; 1000) {
    count += <span data-fragment-index="3" class="fragment custom myem-only">read(socket_fd, input + count, 1000 - count);</span>
} 
...
</code></pre>

