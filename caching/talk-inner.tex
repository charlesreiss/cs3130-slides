\section{caching}

\subsection{memory hierarchy intro}
\input{../caching/memHierarchyIntro}

\subsection{locality}
\input{../caching/localityBasics}

\subsection{direct mapped caches}
\input{../caching/directMappedIntro}

\begin{frame}{terminology}
    \begin{itemize}
    \item row = set
        \begin{itemize}
        \item preview: change how much is in a row
        \end{itemize}
    \end{itemize}
\end{frame}

\subsection{tag/index/offset for direct mapped caches}
\input{../caching/tioDMIntro}

\subsection{tio for DM: exercise}
\input{../caching/tioDmExercise}

\subsection{simulating a direct mapped cache}
\input{../caching/dmExampleAccess}

\subsection{exercise: direct-mapped cache access}
\input{../caching/dmAccessExercise}

\subsection{on split data/instruction caches and hierarchy}
\input{../caching/cacheSplitID}

% FIXME: direct-mapped and C code example
\section{misses in C, and intuition behind conflicts}
\input{../caching/conflictMissesAndC}

\section{array misses warmup}
\input{../caching/arrayMissesWarmupEx}

\section{array misses and cache results}
\input{../caching/arrayMissesEx}

\section{cache misses on more complex code}
\input{../caching/actMissesDM}

\section{array misses and skipping around}
\input{../caching/arrayMissesSkip}

\subsection{adding associativity}
\againframe<13>{pattern1}

\input{../caching/addAssoc}

\subsection{associativity terms}
\input{../caching/assocTerms}

\subsection{tag/index/offset for set-assoc. caches}
\input{../caching/tioFormulas}

\subsection{tag/index/offset exercise}
\subsubsection{setup}
\input{../caching/tioExerciseIntro}
\subsubsection{the exercise}
\input{../caching/tioExercise}

\section{fixing actual misses}
\input{../caching/actMissesAssoc}

\section{array misses warmup, round 2}
\input{../caching/arrayMissesWarmupAssoc}

\againframe<2>{arrayMissesOddEven2}

\subsection{options for replacement}
\input{../caching/replacement}

\subsection{options for handling writes}
\input{../caching/writePolicy}
% FIXME: writes and what counts as a miss

\subsection{exercise: write/replacement policies}
\input{../caching/writeReplaceExercise}

\subsection{fast writes: write buffers}
\input{../caching/fastWrites}

\subsection{miss types}
\input{../caching/missTypes}

\section{cache tradeoffs}
\input{../caching/cacheTradeoffs}

\section{TLB}
\subsection{why cache page table entries?}
\input{../caching/tlbWhy}

\subsection{how TLB fits in page table lookup}
\input{../caching/tlbMulti}

\subsection{how TLBs are organized}
\input{../caching/tlbOrganization} % FIXME: emphasize that AFTER this is normal cache access

\subsection{exercise: splitting for TLBs}
\subsubsection{1}
\input{../caching/tlbSplitEx1}
\subsubsection{2}
\input{../caching/tlbSplitEx2}


\subsection{exercise: TLB access pattern}
\input{../caching/tlbAccessExPrep}
\input{../caching/tlbAccessEx}


\subsection{TLBs and context switches}
\input{../caching/tlbSwitch}

\section{backup slides --- general}

\subsection{inclusive v exclusive}
\input{../caching/exclVIncl}

\subsection{tag/index/offset formulas}
\input{../caching/tioDMFormulas}

\section{backup slides --- cache performance}
\begin{frame}{backup slides --- cache performance}
\end{frame}

\section{AMAT}
\input{../caching/amatFormula}

\subsection{exercise: AMAT (simple case)}
\input{../caching/amatEx}

\subsection{exercise: multi-level cache AMAT}
\input{../caching/multiLevelAMAT}

\section{less precise approxmation}
\input{../caching/approxMisses}

% FIXME: cache performance intro
\section{warmup: locality exercise}  % FIXME: move earlier?
\input{../caching/localityExercise}

\section{warmup: miss counting}
\input{../caching/localityExMissCount}

\section{2D arrays in C}
\input{../caching/c2DArray}
% FIXME: cache blocks and 2D array
\input{../caching/2DArrayBlock}

\section{matrix multiply and loop orders}
\input{../caching/matrixMultIntro}
%\input{../caching/matrixSqIntro}
\input{../caching/matrixMultOrders}
\input{../caching/matrixMultOrdersLocality}
\subsection{exercise: which order?}
\input{../caching/matrixMultOrdersEx} % FIXME: input

% FIXME: move unused?
\subsection{locality: diagrams}
\input{../caching/blockDiagMultIjk}
\input{../caching/blockDiagMult}

\subsection{MM performance}
\againframe<2>{matrixMultTwoVersions}
\input{../caching/matrixMultOrdersPerf}

\subsection{miss counting}
\input{../caching/matrixMultOrdersMisses}

\subsection{miss count exericse}
\input{../caching/localityExMissCount2}

\subsection{jagged edges: conflict misses} % FIXME: cut if not time
\input{../caching/matrixMultOrdersConflicts}


\section{warmup, take two: locality exercise}
\input{../caching/localityExercise2}

\section{cache blocking introduction}
%\input{../caching/blockingIntroSq}
\subsection{transformation --- 1D blocking}
\input{../caching/blockingIntroMultXformK}
\subsubsection{missses in A}
\input{../caching/blockingIntroMultKMissesA}
\subsubsection{missses in B}
\input{../caching/blockingIntroMultKMissesB}
\subsubsection{overall misses}
\input{../caching/blockingIntroMultKMissesOverall}
\subsubsection{actual performance}
\input{../caching/blockingIntroMultKReadMissGraph}

\subsection{two-at-a-time}
\input{../caching/blockingIntro2Mult}
%\input{../caching/blockingGeneralSq}
% FIXME: diagram
%\input{../caching/blockingDivideAndConquerSq} % FIXME: earlier?

\subsection{generalizing}
\input{../caching/blockingDivideAndConquerMult}

\subsection{diagram of general}
\input{../caching/blockingUsageGeneralMult}

%\subsection{locality view}
%\input{../caching/blockDiagSq}
%\input{../caching/loopIneff} % FIXME: drop?

\section{counting loads}
%\input{../caching/loadingCountsSq}
\input{../caching/loadingCountsMult}

\section{exercise}
\input{../caching/localityExMissCount3}


\section{cache blocking review}
\input{../caching/cacheBlockingReview} % FIXME: really before arrays and blocks?


\section{backup slides}
\begin{frame}{backup slides}
\end{frame}

% FIXME:
\subsection{cut example?}
\input{../caching/dmExampleAccessCut}

\subsection{benchmarking and cache results}
\input{../caching/cacheBenchExample}


\section{varying parameters exercise}
    % FIXME: put back?
\input{../caching/cacheTradeoffsEx}

\subsection{misc cache optimizations: prefetching}
    % FIXME: put back? (named in tradeoffs table)
\input{../caching/miscCacheOpt}

\subsection{an old quiz question}
\input{../caching/arrayMissesQuizAnswer}

\subsection{mapping misses to sets (DM)}
\input{../caching/setMappingDiagDM}
\subsection{mapping misses to sets (3-way)}
\input{../caching/setMappingDiag3}

\subsection{sparse array miss exericse}
\input{../caching/arrayMissesExSparseConflicts}

\section{alternate cache miss exericse}
\input{../caching/arrayMissesExSparseAlt}

\section{array misses and cache results (old sparse)}
\input{../caching/arrayMissesExSparse}

\subsection{set mapping (text)}
\input{../caching/setMappingText}



\subsection{addt'l order usage diagrams}
\againframe<6->{ijkCacheUsage}
\againframe<6->{kijCacheUsage}

\subsection{cache blocking: more than two at a time?}
\input{../caching/blockingIntroMultKTo3}
%\input{../caching/blockingIntroMult}
\input{../caching/blockingUsageMult}

\subsection{explicit counting}
\input{../caching/explicitCounting}

\subsection{how TLBs fit in the pipeline}
\input{../caching/tlbPipeline}

