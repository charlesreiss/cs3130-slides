
\begin{frame}[fragile,label=ctxtSwitchPseudo]{context switch pseudocode}
\lstset{
    style=small,
    language=myasm,
    morekeywords={copy_preexception_pc},
}
\begin{lstlisting}
context_switch(last, next):
  copy_preexception_pc last->pc
  mov rax,last->rax 
  mov rcx, last->rcx 
  mov rdx, last->rdx
  ...
  mov next->rdx, rdx
  mov next->rcx, rcx
  mov next->rax, rax
  jmp next->pc
\end{lstlisting}
\end{frame}
